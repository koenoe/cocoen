(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Cocoen = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Cocoen = function () {
  function Cocoen(element, options) {
    _classCallCheck(this, Cocoen);

    this.options = _extends({}, Cocoen.defaults, options);
    this.element = element || document.querySelector('.cocoen');
    this.orientation = this.options.orientation;
    this.element.className = this.element.className + ' ' + this.orientation;

    this.init();
  }

  _createClass(Cocoen, [{
    key: 'init',
    value: function init() {
      this.createElements();
      this.addEventListeners();
    }
  }, {
    key: 'createElements',
    value: function createElements() {
      var _this = this;

      // Create drag element
      var span = document.createElement('span');
      span.className = this.options.dragElementSelector.replace('.', '');
      this.element.appendChild(span);
      // Wrap first image in div
      var wrapper = document.createElement('div');
      var firstImage = this.element.querySelector('img:first-child');
      wrapper.appendChild(firstImage.cloneNode(true));
      firstImage.parentNode.replaceChild(wrapper, firstImage);
      // Set class elements we need later
      this.dragElement = this.element.querySelector(this.options.dragElementSelector);
      this.beforeElement = this.element.querySelector('div:first-child');
      this.beforeImage = this.beforeElement.querySelector('img');

      firstImage.addEventListener('load', function () {
        _this.dimensions();
      });
    }
  }, {
    key: 'addEventListeners',
    value: function addEventListeners() {
      this.element.addEventListener('click', this.onTap.bind(this));
      this.element.addEventListener('mousemove', this.onDrag.bind(this));
      this.element.addEventListener('touchmove', this.onDrag.bind(this));
      this.dragElement.addEventListener('mousedown', this.onDragStart.bind(this));
      this.dragElement.addEventListener('touchstart', this.onDragStart.bind(this));

      window.addEventListener('mouseup', this.onDragEnd.bind(this));
      window.addEventListener('resize', this.dimensions.bind(this));
    }
  }, {
    key: 'dimensions',
    value: function dimensions() {
      if (this.orientation === 'vertical') {
        this.elementWidth = parseInt(window.getComputedStyle(this.element).width, 10);
        this.elementOffsetLeft = this.element.getBoundingClientRect().left + document.body.scrollLeft;
        this.beforeImage.style.width = this.elementWidth + 'px';
        this.dragElementWidth = parseInt(window.getComputedStyle(this.dragElement).width, 10);
        this.minLeftPos = this.elementOffsetLeft + 10;
        this.maxLeftPos = this.elementOffsetLeft + this.elementWidth - this.dragElementWidth - 10;
      } else {
        this.elementHeight = parseInt(window.getComputedStyle(this.element).height, 10);
        this.elementOffsetTop = this.element.getBoundingClientRect().top + document.body.scrollTop;
        this.beforeImage.style.height = this.elementHeight + 'px';
        this.dragElementHeight = parseInt(window.getComputedStyle(this.dragElement).height, 10);
        this.minTopPos = this.elementOffsetTop + 10;
        this.maxTopPos = this.elementOffsetTop + this.elementHeight - this.dragElementHeight - 10;
      }
    }
  }, {
    key: 'onTap',
    value: function onTap(e) {
      e.preventDefault();

      if (this.orientation === 'vertical') {
        this.leftPos = e.pageX ? e.pageX : e.touches[0].pageX;
      } else {
        this.topPos = e.pageY ? e.pageY : e.touches[0].pageY;
      }
      this.requestDrag();
    }
  }, {
    key: 'onDragStart',
    value: function onDragStart(e) {
      e.preventDefault();

      if (this.orientation === 'vertical') {
        var startX = e.pageX ? e.pageX : e.touches[0].pageX;
        var offsetLeft = this.dragElement.getBoundingClientRect().left + document.body.scrollLeft;
        this.posX = offsetLeft + this.dragElementWidth - startX;
      } else {
        var startY = e.pageY ? e.pageY : e.touches[0].pageY;
        var offsetTop = this.dragElement.getBoundingClientRect().top + document.body.scrollTop;
        this.posY = offsetTop + this.dragElementHeight - startY;
      }

      this.isDragging = true;
    }
  }, {
    key: 'onDragEnd',
    value: function onDragEnd(e) {
      e.preventDefault();
      this.isDragging = false;
    }
  }, {
    key: 'onDrag',
    value: function onDrag(e) {
      e.preventDefault();

      if (!this.isDragging) {
        return;
      }

      if (this.orientation === 'vertical') {
        this.moveX = e.pageX ? e.pageX : e.touches[0].pageX;
        this.leftPos = this.moveX + this.posX - this.dragElementWidth;
      } else {
        this.moveY = e.pageY ? e.pageY : e.touches[0].pageY;
        this.topPos = this.moveY + this.posY - this.dragElementHeight;
      }

      this.requestDrag();
    }
  }, {
    key: 'drag',
    value: function drag() {
      var openRatio = void 0;
      if (this.orientation === 'vertical') {
        if (this.leftPos < this.minLeftPos) {
          this.leftPos = this.minLeftPos;
        } else if (this.leftPos > this.maxLeftPos) {
          this.leftPos = this.maxLeftPos;
        }

        openRatio = this.leftPos + this.dragElementWidth / 2 - this.elementOffsetLeft;
        openRatio /= this.elementWidth;
        var width = openRatio * 100 + '%';

        this.dragElement.style.left = width;
        this.beforeElement.style.width = width;
      } else {
        if (this.topPos < this.minTopPos) {
          this.topPos = this.minTopPos;
        } else if (this.topPos > this.maxTopPos) {
          this.topPos = this.maxTopPos;
        }

        openRatio = this.topPos + this.dragElementHeight / 2 - this.elementOffsetTop;
        openRatio /= this.elementHeight;
        var height = openRatio * 100 + '%';

        this.dragElement.style.top = height;
        this.beforeElement.style.height = height;
      }

      if (this.options.dragCallback) {
        this.options.dragCallback(openRatio);
      }
    }
  }, {
    key: 'requestDrag',
    value: function requestDrag() {
      window.requestAnimationFrame(this.drag.bind(this));
    }
  }]);

  return Cocoen;
}();

Cocoen.defaults = {
  dragElementSelector: '.cocoen-drag',
  dragCallback: null,
  orientation: 'vertical'
};

module.exports = Cocoen;

},{}]},{},[1])(1)
});

//# sourceMappingURL=cocoen.min.js.map
